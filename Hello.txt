Daniel has done some changes here.
